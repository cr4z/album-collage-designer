[{"D:\\Dev\\React\\album-collage-designer\\src\\components\\GridContainer.tsx":"1","D:\\Dev\\React\\album-collage-designer\\src\\index.tsx":"2","D:\\Dev\\React\\album-collage-designer\\src\\functions\\itunes.ts":"3","D:\\Dev\\React\\album-collage-designer\\src\\themes\\modal.ts":"4","D:\\Dev\\React\\album-collage-designer\\src\\functions\\downloader.ts":"5","D:\\Dev\\React\\album-collage-designer\\src\\App.tsx":"6","D:\\Dev\\React\\album-collage-designer\\src\\functions\\getCanvas.ts":"7","D:\\Dev\\React\\album-collage-designer\\src\\functions\\waitForImages.ts":"8","D:\\Dev\\React\\album-collage-designer\\src\\functions\\setCssProps.ts":"9","D:\\Dev\\React\\album-collage-designer\\src\\reportWebVitals.ts":"10","D:\\Dev\\React\\album-collage-designer\\src\\themes\\global.ts":"11","D:\\Dev\\React\\album-collage-designer\\src\\contexts\\Modal.tsx":"12"},{"size":6877,"mtime":1606933794382,"results":"13","hashOfConfig":"14"},{"size":500,"mtime":1604855011384,"results":"15","hashOfConfig":"14"},{"size":832,"mtime":1606938073785,"results":"16","hashOfConfig":"14"},{"size":270,"mtime":1606847110484,"results":"17","hashOfConfig":"14"},{"size":245,"mtime":1606857236726,"results":"18","hashOfConfig":"14"},{"size":631,"mtime":1606856795683,"results":"19","hashOfConfig":"14"},{"size":527,"mtime":1606938089217,"results":"20","hashOfConfig":"14"},{"size":674,"mtime":1606857265941,"results":"21","hashOfConfig":"14"},{"size":307,"mtime":1606856495580,"results":"22","hashOfConfig":"14"},{"size":426,"mtime":1604855011384,"results":"23","hashOfConfig":"14"},{"size":500,"mtime":1606008270101,"results":"24","hashOfConfig":"14"},{"size":7278,"mtime":1606847110483,"results":"25","hashOfConfig":"14"},{"filePath":"26","messages":"27","errorCount":0,"warningCount":2,"fixableErrorCount":0,"fixableWarningCount":0,"source":"28","usedDeprecatedRules":"29"},"8ikixd",{"filePath":"30","messages":"31","errorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":"29"},{"filePath":"32","messages":"33","errorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0},{"filePath":"34","messages":"35","errorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":"29"},{"filePath":"36","messages":"37","errorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":"29"},{"filePath":"38","messages":"39","errorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":"29"},{"filePath":"40","messages":"41","errorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0},{"filePath":"42","messages":"43","errorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":"29"},{"filePath":"44","messages":"45","errorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":"29"},{"filePath":"46","messages":"47","errorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":"29"},{"filePath":"48","messages":"49","errorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":"29"},{"filePath":"50","messages":"51","errorCount":0,"warningCount":2,"fixableErrorCount":0,"fixableWarningCount":0,"source":"52","usedDeprecatedRules":"29"},"D:\\Dev\\React\\album-collage-designer\\src\\components\\GridContainer.tsx",["53","54"],"import React, {\r\n  useCallback,\r\n  useContext,\r\n  useEffect,\r\n  useRef,\r\n  useState,\r\n} from \"react\";\r\nimport { ModalContext } from \"../contexts/Modal\";\r\nimport { Button, CircularProgress, TextField } from \"@material-ui/core\";\r\n\r\nimport { setCssProps } from \"../functions/setCssProps\";\r\nimport { waitForImagesToLoad } from \"../functions/waitForImages\";\r\nimport { getCanvas } from \"../functions/getCanvas\";\r\nimport { downloadImageFromURL } from \"../functions/downloader\";\r\n\r\nexport function GridContainer() {\r\n  const ctx = useContext(ModalContext);\r\n  if (!ctx) throw new Error(\"Context not received!\");\r\n\r\n  const [inputNumColumns, setInputNumColumns] = useState<number>(5);\r\n  const [inputNumRows, setInputNumRows] = useState<number>(10);\r\n  const [officialNumColumns, setOfficialNumColumns] = useState<number>(5);\r\n  const [officialNumRows, setOfficialNumRows] = useState<number>(10);\r\n\r\n  const [gridIsLoading, setGridIsLoading] = useState<boolean>(false);\r\n  const [downloadInProgress, setDownloadInProgress] = useState<boolean>(false);\r\n\r\n  const [officialImages, setOfficialImages] = useState<HTMLImageElement[]>([]);\r\n  const officialImagesRef = useRef<HTMLImageElement[]>();\r\n  officialImagesRef.current = officialImages;\r\n\r\n  const onGridInitialized = useCallback((initialImages: HTMLImageElement[]) => {\r\n    setOfficialImages([...initialImages]);\r\n  }, []);\r\n\r\n  const onItemSet = useCallback((index: number, newSrc: string) => {\r\n    const old = officialImagesRef.current;\r\n\r\n    if (old) {\r\n      const newImages = [...old];\r\n      newImages[index].src = newSrc;\r\n\r\n      //set the official image\r\n      setOfficialImages(newImages);\r\n    } else throw new Error(\"Ref was not assigned!\");\r\n  }, []);\r\n\r\n  return (\r\n    <>\r\n      <div className=\"grid-text-field-container\">\r\n        <div className=\"input-fields-container\">\r\n          <div className=\"text-field\">\r\n            <TextField\r\n              label=\"Columns\"\r\n              defaultValue=\"5\"\r\n              variant=\"outlined\"\r\n              onChange={(e) => setInputNumColumns(+e.target.value)}\r\n            />\r\n          </div>\r\n          <div className=\"text-field\">\r\n            <TextField\r\n              label=\"Rows\"\r\n              defaultValue=\"10\"\r\n              variant=\"outlined\"\r\n              onChange={(e) => setInputNumRows(+e.target.value)}\r\n            />\r\n          </div>\r\n        </div>\r\n        <div>\r\n          <Button\r\n            disabled={gridIsLoading || downloadInProgress}\r\n            size=\"large\"\r\n            onClick={() => {\r\n              if (inputNumColumns * inputNumRows < 500) {\r\n                setOfficialNumColumns(inputNumColumns);\r\n                setOfficialNumRows(inputNumRows);\r\n              } else\r\n                alert(\r\n                  \"Slow your roll Picasso! We can't go over 500 total cells!\"\r\n                );\r\n            }}\r\n          >\r\n            Set!\r\n          </Button>\r\n        </div>\r\n      </div>\r\n\r\n      <Grid\r\n        onGridInitialized={onGridInitialized}\r\n        gridValues={{\r\n          numColumns: officialNumColumns,\r\n          numRows: officialNumRows,\r\n        }}\r\n        gridState={{ gridIsLoading, setGridIsLoading }}\r\n        onItemSet={(index: number, newSrc: string) => onItemSet(index, newSrc)}\r\n      />\r\n\r\n      <br />\r\n      <div className=\"download-container\">\r\n        <div>\r\n          <Button\r\n            color=\"primary\"\r\n            size=\"large\"\r\n            disabled={gridIsLoading || downloadInProgress}\r\n            onClick={() => {\r\n              onDownloadButtonDown(\r\n                officialImages,\r\n                {\r\n                  numColumns: inputNumColumns,\r\n                  numRows: inputNumRows,\r\n                },\r\n                setDownloadInProgress\r\n              );\r\n            }}\r\n          >\r\n            Download!\r\n          </Button>\r\n        </div>\r\n\r\n        <div className=\"download-progress-spinner\">\r\n          {downloadInProgress && <CircularProgress />}\r\n        </div>\r\n      </div>\r\n    </>\r\n  );\r\n}\r\n\r\nconst onDownloadButtonDown = async (\r\n  images: HTMLImageElement[],\r\n  gridValues: { numColumns: number; numRows: number },\r\n  setDownloadInProgress: Function\r\n) => {\r\n  setDownloadInProgress(true);\r\n\r\n  const imageSources: string[] = images.map((img) => {\r\n    return img.src;\r\n  });\r\n\r\n  const url = await getCanvas(gridValues, imageSources);\r\n  console.log(url.length);\r\n\r\n  downloadImageFromURL(url);\r\n\r\n  setDownloadInProgress(false);\r\n};\r\n\r\nconst Grid = (props: {\r\n  gridValues: { numColumns: number; numRows: number };\r\n  gridState: { gridIsLoading: any; setGridIsLoading: Function };\r\n  onGridInitialized: Function;\r\n  onItemSet: Function;\r\n}) => {\r\n  const { gridState } = props;\r\n  const { numColumns, numRows } = props.gridValues;\r\n  const total = numColumns * numRows;\r\n\r\n  const [cellItems, setCellItems] = useState<JSX.Element[]>([]);\r\n\r\n  useEffect(() => {\r\n    //initialize grid; generate and assign CellItems\r\n\r\n    gridState.setGridIsLoading(true);\r\n\r\n    //generate new array of images\r\n    const newImages: HTMLImageElement[] = [];\r\n    for (let i = 0; i < total; i++) {\r\n      const newImg = new Image();\r\n      newImg.src = `https://picsum.photos/seed/${Math.random()}/1000`;\r\n      newImages.push(newImg);\r\n    }\r\n\r\n    //init css\r\n    setCssProps({ numColumns: numColumns, numRows: numRows });\r\n\r\n    //wait for image array to load\r\n    waitForImagesToLoad(newImages).then(() => {\r\n      //generate new array of cellitems\r\n\r\n      const newCellItems: JSX.Element[] = [];\r\n      let i: number = -1;\r\n\r\n      newImages.forEach((image) => {\r\n        i++;\r\n\r\n        const newItem = (\r\n          <CellItem\r\n            initialSource={image.src}\r\n            index={i}\r\n            onItemSet={(index: number, newSrc: string) =>\r\n              props.onItemSet(index, newSrc)\r\n            }\r\n          />\r\n        );\r\n\r\n        newCellItems.push(newItem);\r\n      });\r\n\r\n      setCellItems(newCellItems);\r\n\r\n      //finally, set grid state to not loading\r\n      props.onGridInitialized(newImages);\r\n      gridState.setGridIsLoading(false);\r\n    });\r\n  }, [numColumns, numRows]);\r\n\r\n  return gridState.gridIsLoading ? (\r\n    <CircularProgress color=\"secondary\" style={{ margin: 100 }} />\r\n  ) : (\r\n    <div className=\"grid\">{cellItems}</div>\r\n  );\r\n};\r\n\r\nfunction CellItem(props: {\r\n  initialSource: string;\r\n  index: number;\r\n  onItemSet: Function;\r\n}) {\r\n  const context = useContext(ModalContext);\r\n\r\n  const [src, setSrc] = useState<string>(props.initialSource);\r\n\r\n  const onImageReceieved = useCallback((newSource: string) => {\r\n    setSrc(newSource);\r\n    props.onItemSet(props.index, newSource);\r\n  }, []);\r\n\r\n  return (\r\n    <img\r\n      className=\"cell-item\"\r\n      src={src}\r\n      alt=\"album cover\"\r\n      onClick={() => {\r\n        if (context) {\r\n          context.openModal(() => onImageReceieved);\r\n        }\r\n      }}\r\n    ></img>\r\n  );\r\n}\r\n",["55","56"],"D:\\Dev\\React\\album-collage-designer\\src\\index.tsx",[],"D:\\Dev\\React\\album-collage-designer\\src\\functions\\itunes.ts",[],"D:\\Dev\\React\\album-collage-designer\\src\\themes\\modal.ts",[],"D:\\Dev\\React\\album-collage-designer\\src\\functions\\downloader.ts",[],"D:\\Dev\\React\\album-collage-designer\\src\\App.tsx",[],"D:\\Dev\\React\\album-collage-designer\\src\\functions\\getCanvas.ts",[],"D:\\Dev\\React\\album-collage-designer\\src\\functions\\waitForImages.ts",[],"D:\\Dev\\React\\album-collage-designer\\src\\functions\\setCssProps.ts",[],"D:\\Dev\\React\\album-collage-designer\\src\\reportWebVitals.ts",[],"D:\\Dev\\React\\album-collage-designer\\src\\themes\\global.ts",[],"D:\\Dev\\React\\album-collage-designer\\src\\contexts\\Modal.tsx",["57","58"],"import React, {\r\n  createContext,\r\n  useCallback,\r\n  useRef,\r\n  useState,\r\n} from \"react\";\r\nimport { FontAwesomeIcon } from \"@fortawesome/react-fontawesome\";\r\nimport { faTimes } from \"@fortawesome/free-solid-svg-icons\";\r\nimport {\r\n  Button,\r\n  CircularProgress,\r\n  TextField,\r\n  ThemeProvider,\r\n} from \"@material-ui/core\";\r\nimport { ModalTheme } from \"../themes/modal\";\r\nimport * as iTunes from \"../functions/itunes\";\r\n\r\ninterface IModalContext {\r\n  openModal: Function;\r\n}\r\n\r\ninterface ITagObject {\r\n  elem: JSX.Element;\r\n  label: string;\r\n}\r\n\r\nexport const ModalContext = createContext<IModalContext | null>(null);\r\n\r\nconst ModalContextProvider = (props: any) => {\r\n  const [modalOpen, setModalOpen] = useState<boolean>(false);\r\n  const [input, setInput] = useState<string>(\"\");\r\n  const [gridCallback, setGridCallback] = useState<Function | null>(null);\r\n  const [loadingResults, setLoadingResults] = useState<boolean>(false);\r\n  const [sources, setSources] = useState<string[]>([]);\r\n  const [welcomeMessage, setWelcomeMessage] = useState<string>(\"\");\r\n  const [tagObjects, setTagObjects] = useState<ITagObject[]>([]);\r\n  const tagObjectsRef = useRef(tagObjects);\r\n  tagObjectsRef.current = tagObjects;\r\n\r\n  const onImagesReturned = useCallback((results: string[]) => {\r\n    setSources(results);\r\n    setLoadingResults(false);\r\n  }, []);\r\n\r\n  const submitBtnRef = useRef<HTMLButtonElement | null>(null);\r\n\r\n  const ctx = {\r\n    openModal: (inputCallback: Function) => {\r\n      setModalOpen(true);\r\n      setGridCallback((x: string) => inputCallback(x));\r\n    },\r\n  };\r\n\r\n  const onImageSelected = useCallback(\r\n    (src: string) => {\r\n      if (gridCallback) {\r\n        gridCallback(src);\r\n        setModalOpen(false);\r\n      } else {\r\n        throw new Error(\"Callback doesn't exist!\");\r\n      }\r\n    },\r\n    [gridCallback]\r\n  );\r\n\r\n  const [pageInView, setPageInView] = useState<number>(0);\r\n  const resultsPerPage = 6;\r\n  const offset = pageInView * resultsPerPage;\r\n  const results: JSX.Element[] = [];\r\n  for (let i = 0; i < resultsPerPage; i++) {\r\n    if (sources[i + offset]) {\r\n      results.push(\r\n        <Result src={sources[i + offset]} onImageSelected={onImageSelected} />\r\n      );\r\n    }\r\n  }\r\n\r\n  const prevPage = useCallback(() => {\r\n    setPageInView(pageInView - 1);\r\n  }, [pageInView]);\r\n\r\n  const nextPage = useCallback(() => {\r\n    setPageInView(pageInView + 1);\r\n  }, [pageInView]);\r\n\r\n  const addTag = useCallback((input: string) => {\r\n    let labels = tagObjectsRef.current.map((a) => a.label);\r\n\r\n    if (labels.includes(input)) return;\r\n    if (tagObjectsRef.current.length > 15) return;\r\n    if (input.length > 30) return;\r\n\r\n    const newElem = (\r\n      <Tag\r\n        label={input}\r\n        onTagSearch={(label: string) => onTagSearch(label)}\r\n        onTagDelete={(label: string) => onTagDelete(label)}\r\n      />\r\n    );\r\n\r\n    const newTag = { elem: newElem, label: input };\r\n    setTagObjects((old: any) => [...old, newTag]);\r\n  }, []);\r\n\r\n  const onTagSearch = useCallback((label: string) => {\r\n    iTunes.getImagesFromInput(label, onImagesReturned);\r\n    setPageInView(0);\r\n  }, []);\r\n\r\n  const onTagDelete = useCallback((label: string) => {\r\n    const filtered: ITagObject[] = tagObjectsRef.current.filter(\r\n      (tag) => label !== tag.label\r\n    );\r\n    setTagObjects(filtered);\r\n  }, []);\r\n\r\n  return (\r\n    <ModalContext.Provider value={{ ...ctx }}>\r\n      {modalOpen && (\r\n        <ThemeProvider theme={ModalTheme}>\r\n          <div className=\"modal-backdrop\">\r\n            <div className=\"modal-holder\">\r\n              <div className=\"modal\">\r\n                <div className=\"modal-header\">\r\n                  Add an album\r\n                  <FontAwesomeIcon\r\n                    className=\"modal-ex-btn\"\r\n                    onClick={() => setModalOpen(false)}\r\n                    icon={faTimes}\r\n                  />\r\n                </div>\r\n                <div className=\"modal-divider\" />\r\n\r\n                <div className=\"modal-search-bar\">\r\n                  <TextField\r\n                    fullWidth\r\n                    placeholder=\"Search for an artist or album...\"\r\n                    variant=\"outlined\"\r\n                    size=\"small\"\r\n                    onChange={(e) => setInput(e.target.value)}\r\n                    onKeyDown={(e) => {\r\n                      if (e.key === \"Enter\") {\r\n                        const btn = submitBtnRef.current;\r\n                        if (btn) {\r\n                          btn.click();\r\n                        } else throw new Error(\"Submit button doesn't exist!\");\r\n                      }\r\n                    }}\r\n                  />\r\n                </div>\r\n\r\n                <div className=\"tags-container\">\r\n                  {tagObjects.map((obj) => obj.elem)}\r\n                </div>\r\n\r\n                {sources.length > 0 ? (\r\n                  <div className=\"modal-grid\">{results}</div>\r\n                ) : loadingResults ? (\r\n                  <CircularProgress />\r\n                ) : (\r\n                  <span>{welcomeMessage}</span>\r\n                )}\r\n\r\n                <div className=\"modal-button-container\">\r\n                  <div>\r\n                    <Button disabled={pageInView < 1} onClick={prevPage}>\r\n                      👈\r\n                    </Button>\r\n                  </div>\r\n                  <div>\r\n                    <Button\r\n                      disabled={results.length < resultsPerPage}\r\n                      onClick={nextPage}\r\n                    >\r\n                      👉\r\n                    </Button>\r\n                  </div>\r\n                </div>\r\n\r\n                <div className=\"modal-divider\" />\r\n                <div className=\"modal-footer\">\r\n                  <Button\r\n                    variant=\"contained\"\r\n                    color=\"primary\"\r\n                    disableElevation={true}\r\n                    ref={submitBtnRef}\r\n                    onClick={async () => {\r\n                      addTag(input);\r\n                      setSources([]);\r\n                      setWelcomeMessage(\"Hm, nothing found :(\");\r\n                      setLoadingResults(true);\r\n                      iTunes.getImagesFromInput(input, onImagesReturned);\r\n                      setPageInView(0);\r\n                    }}\r\n                  >\r\n                    Search\r\n                  </Button>\r\n                </div>\r\n              </div>\r\n            </div>\r\n          </div>\r\n        </ThemeProvider>\r\n      )}\r\n      {props.children}\r\n    </ModalContext.Provider>\r\n  );\r\n};\r\n\r\nfunction Tag(props: {\r\n  label: string;\r\n  onTagSearch: Function;\r\n  onTagDelete: Function;\r\n}) {\r\n  const { label, onTagSearch, onTagDelete } = props;\r\n\r\n  return (\r\n    <span className=\"tag\">\r\n      <span className=\"tag-text\" onClick={() => onTagSearch(label)}>\r\n        {label}{\" \"}\r\n      </span>\r\n      <span onClick={() => onTagDelete(label)}>❌</span>\r\n    </span>\r\n  );\r\n}\r\n\r\nfunction Result(props: { src: string; onImageSelected: Function }) {\r\n  return (\r\n    <div className=\"modal-grid-result\">\r\n      <img\r\n        onClick={() => props.onImageSelected(props.src)}\r\n        width={200}\r\n        height={200}\r\n        src={props.src}\r\n        alt=\"result\"\r\n      />\r\n    </div>\r\n  );\r\n}\r\n\r\nexport default ModalContextProvider;\r\n",{"ruleId":"59","severity":1,"message":"60","line":204,"column":6,"nodeType":"61","endLine":204,"endColumn":27,"suggestions":"62"},{"ruleId":"59","severity":1,"message":"63","line":225,"column":6,"nodeType":"61","endLine":225,"endColumn":8,"suggestions":"64"},{"ruleId":"65","replacedBy":"66"},{"ruleId":"67","replacedBy":"68"},{"ruleId":"59","severity":1,"message":"69","line":103,"column":6,"nodeType":"61","endLine":103,"endColumn":8,"suggestions":"70"},{"ruleId":"59","severity":1,"message":"71","line":108,"column":6,"nodeType":"61","endLine":108,"endColumn":8,"suggestions":"72"},"react-hooks/exhaustive-deps","React Hook useEffect has missing dependencies: 'gridState', 'props', and 'total'. Either include them or remove the dependency array. However, 'props' will change when *any* prop changes, so the preferred fix is to destructure the 'props' object outside of the useEffect call and refer to those specific props inside useEffect.","ArrayExpression",["73"],"React Hook useCallback has a missing dependency: 'props'. Either include it or remove the dependency array. However, 'props' will change when *any* prop changes, so the preferred fix is to destructure the 'props' object outside of the useCallback call and refer to those specific props inside useCallback.",["74"],"no-native-reassign",["75"],"no-negated-in-lhs",["76"],"React Hook useCallback has missing dependencies: 'onTagDelete' and 'onTagSearch'. Either include them or remove the dependency array.",["77"],"React Hook useCallback has a missing dependency: 'onImagesReturned'. Either include it or remove the dependency array.",["78"],{"desc":"79","fix":"80"},{"desc":"81","fix":"82"},"no-global-assign","no-unsafe-negation",{"desc":"83","fix":"84"},{"desc":"85","fix":"86"},"Update the dependencies array to be: [gridState, numColumns, numRows, props, total]",{"range":"87","text":"88"},"Update the dependencies array to be: [props]",{"range":"89","text":"90"},"Update the dependencies array to be: [onTagDelete, onTagSearch]",{"range":"91","text":"92"},"Update the dependencies array to be: [onImagesReturned]",{"range":"93","text":"94"},[6077,6098],"[gridState, numColumns, numRows, props, total]",[6631,6633],"[props]",[2968,2970],"[onTagDelete, onTagSearch]",[3117,3119],"[onImagesReturned]"]