(this.webpackJsonpalbum2=this.webpackJsonpalbum2||[]).push([[0],{62:function(e,t,n){},63:function(e,t,n){},71:function(e,t,n){"use strict";n.r(t);var c=n(4),a=n(0),r=n.n(a),s=n(8),i=n.n(s),o=(n(62),n(63),n(12)),l=n.n(o),u=n(14),d=n(52),j=n(28),b=n(11),m=n(45),O=n(49),f=n(101),h=n(106),p=n(104),v=n(107),x=n(51),g=Object(x.a)({palette:{type:"light"},props:{MuiButton:{variant:"contained",disableElevation:!0,size:"large"}}}),C=function(){var e=Object(u.a)(l.a.mark((function e(t,n){var c,a,r,s,i,o;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return c=encodeURIComponent(t).replace(/%20/g,"+"),a=encodeURIComponent("https://itunes.apple.com/search?term=".concat(c,"&entity=album&media=music")),e.next=4,fetch("/proxy/".concat(a),{method:"GET"});case 4:return r=e.sent,e.next=7,r.json();case 7:s=e.sent,i=s.results,o=[],i.forEach((function(e){var t=e.artworkUrl100;t=t.replace(/100x100/g,"200x200"),o.includes(t)||o.push(t)})),n(o);case 12:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),w=Object(a.createContext)(null);function S(e){var t=e.label,n=e.onTagSearch,a=e.onTagDelete;return Object(c.jsxs)("span",{className:"tag",children:[Object(c.jsxs)("span",{className:"tag-text",onClick:function(){return n(t)},children:[t," "]}),Object(c.jsx)("span",{onClick:function(){return a(t)},children:"\u274c"})]})}function k(e){return Object(c.jsx)("div",{className:"modal-grid-result",children:Object(c.jsx)("img",{onClick:function(){return e.onImageSelected(e.src)},width:200,height:200,src:e.src,alt:"result"})})}var y=function(e){var t=Object(a.useState)(!1),n=Object(b.a)(t,2),r=n[0],s=n[1],i=Object(a.useState)(""),o=Object(b.a)(i,2),x=o[0],y=o[1],N=Object(a.useState)(null),I=Object(b.a)(N,2),E=I[0],R=I[1],T=Object(a.useState)(!1),z=Object(b.a)(T,2),P=z[0],L=z[1],M=Object(a.useState)([]),D=Object(b.a)(M,2),F=D[0],G=D[1],B=Object(a.useState)(""),U=Object(b.a)(B,2),V=U[0],A=U[1],J=Object(a.useState)([]),W=Object(b.a)(J,2),H=W[0],K=W[1],q=Object(a.useRef)(H);q.current=H;for(var Q=Object(a.useCallback)((function(e){G(e),L(!1)}),[]),X=Object(a.useRef)(null),Y={openModal:function(e){s(!0),R((function(t){return e(t)}))}},Z=Object(a.useCallback)((function(e){if(!E)throw new Error("Callback doesn't exist!");E(e),s(!1)}),[E]),$=Object(a.useState)(0),_=Object(b.a)($,2),ee=_[0],te=_[1],ne=6*ee,ce=[],ae=0;ae<6;ae++)F[ae+ne]&&ce.push(Object(c.jsx)(k,{src:F[ae+ne],onImageSelected:Z}));var re=Object(a.useCallback)((function(){te(ee-1)}),[ee]),se=Object(a.useCallback)((function(){te(ee+1)}),[ee]),ie=Object(a.useCallback)((function(e){if(!q.current.map((function(e){return e.label})).includes(e)&&!(q.current.length>4)&&!(e.length>30)){var t={elem:Object(c.jsx)(S,{label:e,onTagSearch:function(e){return oe(e)},onTagDelete:function(e){return le(e)}}),label:e};K((function(e){return[].concat(Object(j.a)(e),[t])}))}}),[]),oe=Object(a.useCallback)((function(e){C(e,Q),te(0)}),[]),le=Object(a.useCallback)((function(e){var t=q.current.filter((function(t){return e!==t.label}));K(t)}),[]);return Object(c.jsxs)(w.Provider,{value:Object(d.a)({},Y),children:[r&&Object(c.jsx)(f.a,{theme:g,children:Object(c.jsx)("div",{className:"modal-backdrop",children:Object(c.jsx)("div",{className:"modal-holder",children:Object(c.jsxs)("div",{className:"modal",children:[Object(c.jsxs)("div",{className:"modal-header",children:["Add an album",Object(c.jsx)(m.a,{className:"modal-ex-btn",onClick:function(){return s(!1)},icon:O.a})]}),Object(c.jsx)("div",{className:"modal-divider"}),Object(c.jsx)("div",{className:"modal-search-bar",children:Object(c.jsx)(h.a,{fullWidth:!0,placeholder:"Search for an artist or album...",variant:"outlined",size:"small",onChange:function(e){return y(e.target.value)},onKeyDown:function(e){if("Enter"===e.key){var t=X.current;if(!t)throw new Error("Submit button doesn't exist!");t.click()}}})}),Object(c.jsx)("div",{className:"tags-container",children:H.map((function(e){return e.elem}))}),F.length>0?Object(c.jsx)("div",{className:"modal-grid",children:ce}):P?Object(c.jsx)(p.a,{}):Object(c.jsx)("span",{children:V}),Object(c.jsxs)("div",{className:"modal-button-container",children:[Object(c.jsx)("div",{children:Object(c.jsx)(v.a,{disabled:ee<1,onClick:re,children:"\ud83d\udc48"})}),Object(c.jsx)("div",{children:Object(c.jsx)(v.a,{disabled:ce.length<6,onClick:se,children:"\ud83d\udc49"})})]}),Object(c.jsx)("div",{className:"modal-divider"}),Object(c.jsx)("div",{className:"modal-footer",children:Object(c.jsx)(v.a,{variant:"contained",color:"primary",disableElevation:!0,ref:X,onClick:Object(u.a)(l.a.mark((function e(){return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:ie(x),G([]),A("Hm, nothing found :("),L(!0),C(x,Q),te(0);case 6:case"end":return e.stop()}}),e)}))),children:"Search"})})]})})})}),e.children]})},N=n(105),I=n(37),E=Object(x.a)({props:{MuiButton:{disableElevation:!0,size:"small",variant:"contained"},MuiTextField:{variant:"outlined",size:"small"}},palette:{primary:N.a,secondary:I.a,type:"dark"}}),R=function(){var e=Object(u.a)(l.a.mark((function e(t){var n;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=[],t.map(function(){var e=Object(u.a)(l.a.mark((function e(t){return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n.push(new Promise((function(e){t.complete?0!==t.naturalWidth&&0!==t.naturalHeight&&e():t.onload=function(){e()}})));case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()),e.next=4,Promise.allSettled(n);case 4:return e.abrupt("return",t);case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),T=function(){var e=Object(u.a)(l.a.mark((function e(t,n){var c,a,r,s,i;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return c=t.numColumns,a=t.numRows,r=JSON.stringify(n),s=encodeURIComponent(r),i="",e.next=6,fetch("/generateCanvas/".concat(c,"/").concat(a,"/").concat(s)).then((function(e){return e.json()})).then((function(e){i=e}));case 6:return e.abrupt("return",i);case 7:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),z=function(e){var t=document.createElement("a");t.href=e,t.download="album-collage-designer.png",document.body.appendChild(t),t.click(),t.remove()};function P(){if(!Object(a.useContext)(w))throw new Error("Context not received!");var e=Object(a.useState)(4),t=Object(b.a)(e,2),n=t[0],r=t[1],s=Object(a.useState)(8),i=Object(b.a)(s,2),o=i[0],l=i[1],u=Object(a.useState)(4),d=Object(b.a)(u,2),m=d[0],O=d[1],f=Object(a.useState)(8),x=Object(b.a)(f,2),g=x[0],C=x[1],S=Object(a.useState)(!1),k=Object(b.a)(S,2),y=k[0],N=k[1],I=Object(a.useState)(!1),E=Object(b.a)(I,2),R=E[0],T=E[1],z=Object(a.useState)([]),P=Object(b.a)(z,2),D=P[0],F=P[1],G=Object(a.useRef)();G.current=D;var B=Object(a.useCallback)((function(e){F(Object(j.a)(e))}),[]),U=Object(a.useCallback)((function(e,t){var n=G.current;if(!n)throw new Error("Ref was not assigned!");var c=Object(j.a)(n);c[e].src=t,F(c)}),[]);return Object(c.jsxs)(c.Fragment,{children:[Object(c.jsxs)("div",{className:"grid-text-field-container",children:[Object(c.jsxs)("div",{className:"input-fields-container",children:[Object(c.jsx)("div",{className:"text-field",children:Object(c.jsx)(h.a,{label:"Columns",defaultValue:4,variant:"outlined",onChange:function(e){return r(+e.target.value)}})}),Object(c.jsx)("div",{className:"text-field",children:Object(c.jsx)(h.a,{label:"Rows",defaultValue:8,variant:"outlined",onChange:function(e){return l(+e.target.value)}})})]}),Object(c.jsx)("div",{children:Object(c.jsx)(v.a,{disabled:y||R,size:"large",onClick:function(){window.confirm("This will reset your current images! Continue?")&&(n*o<500?(O(n),C(o)):alert("Slow your roll Picasso! We can't go over 500 total cells!"))},children:"Set!"})})]}),Object(c.jsx)(M,{onGridInitialized:B,gridValues:{numColumns:m,numRows:g},gridState:{gridIsLoading:y,setGridIsLoading:N},onItemSet:function(e,t){return U(e,t)}}),Object(c.jsx)("br",{}),Object(c.jsxs)("div",{className:"download-container",children:[Object(c.jsx)("div",{children:Object(c.jsx)(v.a,{color:"primary",size:"large",disabled:y||R,onClick:function(){L(D,{numColumns:n,numRows:o},T)},children:"Download!"})}),Object(c.jsx)("div",{className:"download-progress-spinner",children:R&&Object(c.jsx)(p.a,{})})]})]})}var L=function(){var e=Object(u.a)(l.a.mark((function e(t,n,c){var a,r;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return c(!0),a=t.map((function(e){return e.src})),e.next=4,T(n,a);case 4:r=e.sent,console.log(r.length),z(r),c(!1);case 8:case"end":return e.stop()}}),e)})));return function(t,n,c){return e.apply(this,arguments)}}(),M=function(e){var t=e.gridState,n=e.gridValues,r=n.numColumns,s=n.numRows,i=r*s,o=Object(a.useState)([]),l=Object(b.a)(o,2),u=l[0],d=l[1];return Object(a.useEffect)((function(){t.setGridIsLoading(!0);for(var n=[],a=0;a<i;a++){var o=new Image;o.src="https://picsum.photos/seed/".concat(Math.random(),"/1000"),n.push(o)}!function(e){var t=document.documentElement.style,n=e.numColumns,c=e.numRows;t.setProperty("--num-columns",n.toString()),t.setProperty("--num-rows",c.toString())}({numColumns:r,numRows:s}),R(n).then((function(){var a=[],r=-1;n.forEach((function(t){r++;var n=Object(c.jsx)(D,{initialSource:t.src,index:r,onItemSet:function(t,n){return e.onItemSet(t,n)}});a.push(n)})),d(a),e.onGridInitialized(n),t.setGridIsLoading(!1)}))}),[r,s]),t.gridIsLoading?Object(c.jsx)(p.a,{color:"secondary",style:{margin:100}}):Object(c.jsx)("div",{className:"grid",children:u})};function D(e){var t=Object(a.useContext)(w),n=Object(a.useState)(e.initialSource),r=Object(b.a)(n,2),s=r[0],i=r[1],o=Object(a.useCallback)((function(t){i(t),e.onItemSet(e.index,t)}),[]);return Object(c.jsx)("img",{className:"cell-item",src:s,alt:"album cover",onClick:function(){t&&t.openModal((function(){return o}))}})}var F=function(){return Object(c.jsx)("div",{className:"App",children:Object(c.jsx)(f.a,{theme:E,children:Object(c.jsxs)(y,{children:[Object(c.jsx)("header",{children:"\ud83c\udfa8 Album Collage Designer\ud83d\udd8c\ufe0f"}),Object(c.jsx)(P,{})]})})})},G=function(e){e&&e instanceof Function&&n.e(3).then(n.bind(null,108)).then((function(t){var n=t.getCLS,c=t.getFID,a=t.getFCP,r=t.getLCP,s=t.getTTFB;n(e),c(e),a(e),r(e),s(e)}))};i.a.render(Object(c.jsx)(r.a.StrictMode,{children:Object(c.jsx)(F,{})}),document.getElementById("root")),G()}},[[71,1,2]]]);
//# sourceMappingURL=main.60874ba7.chunk.js.map